# May 2025 TIL (Today I Learned)

This file contains things I learned during May 2025.

---

## 2025-05-14: 最近気になっているガジェット

[Tern Setups](https://ternsetups.com/)

モニタとスタンドが一体となっていて、かなりポータビリティが高そう。

[Samsung The Premiere 5 Full HD Touch Interaction Projector (2025)](https://www.samsung.com/uk/projectors/the-premiere/lpf5-touch-interaction-projector-sp-lpf5dsaxxxu/)

持ち運びしやすいし、発色すごいし、使い方の幅広さがすごい。日本で発売するかどうかと、価格がどうなるかが気になるところ。。

---

## 2025-05-13: Barrel import / export のメリデメ

### Barrel import/exportとは何か

- index.tsで複数モジュールをまとめて再エクスポートする手法

### メリット

- import文が簡潔になる
- モジュールのエントリーポイントを統一できる
- リファクタやファイル構成変更時の影響範囲を減らせる

### デメリット

- 循環参照が発生しやすくなる
- 依存関係が増える
- 依存関係が不明瞭になりやすい
- 別で既にindex.tsが存在する場合の共存どうする問題がある
- ツリーシェイキングが効かなくなる場合がある
- コーディング時も考慮事項が増える

### まとめ・所感

- 正直いらないと思う
- eslint-plugin-no-barrel-filesを導入して、barrelファイルとなるindex.tsを禁止するのが良いかも

### 参考

- <https://typescript-jp.gitbook.io/deep-dive/main-1/barrel>
- <https://developers.prtimes.jp/2025/01/28/avoid-barrel-files-in-prtimes/>

---

## 2025-05-12: TanStack Query / SWRが導入されていないプロジェクトでのAPIリクエスト競合状態の回避法

TanStack QueryやSWRは、データフェッチライブラリではなく、非同期な状態管理ライブラリである。これらの"sane
defaults"により、APIなどの非同期状態のハンドリングがカバーされる。

ただし、未導入のプロジェクトでは、場当たり的なAPIリクエスト競合回避が必要になる場合がある。以下はReact
Router前提だが、Vanilla JSでも応用可能。

```ts
import { matchPath } from 'react-router';
import { z } from 'zod';
import { isValid, parse } from 'date-fns';

const yearMonthParamSchema = z.string().refine(
  val => {
    const parsedDate = parse(val, 'yyyy-MM', new Date());
    return isValid(parsedDate);
  },
  {
    message: 'Invalid yearMonth format',
  }
);

// `/page-name/2025-05`のパス例
const getCurrentSelectedYearMonthParam = () => {
  const pathMatch = matchPath('page-name/:selectedYearMonth');
  if (!pathMatch) return;

  const result = yearMonthParamSchema.safeParse(pathMatch.params.selectedYearMonth);
  if (!result.success) return;

  return result.data;
};

export const fetchData = async (params: { yearMonth: string }) => {
  const response = await fetch(`/api/v1/collection?yearMonth=${params.yearMonth}`);

  if (isHttpError(response)) {
    handleHttpError(response);
    return;
  }

  const currentSelectedYearMonthParam = getCurrentSelectedYearMonthParam();
  if (typeof currentSelectedYearMonthParam === 'undefined' || currentSelectedYearMonthParam !== params.yearMonth) {
    // 競合状態を回避するために、APIリクエストの結果を無視する
    return;
  }

  const data = await response.json();

  return data;
};
```

- レースコンディション
- ウォーターフォール問題

などの根本解決にはならないが、場当たり的なAPIリクエスト競合回避としては十分に機能する。

---

## 2025-05-11: ClineをGitHub Copilot Proの有料プランで使う

### Clineとは

- オープンソースのAIエージェント。コード生成や質問応答が可能。
- カスタマイズ性が高く、様々なモデル・エディタ・プロンプト・カスタムフォークに対応。
- エクステンションなので、あらゆるエディタで利用可能（Cursor, Windsurf, Bolt.new等と異なる点）。

参考：

- <https://cline.bot/>
- <https://youtu.be/TFU33etuKb0?si=VYo2BY7UJXtd9hCI>

### できるだけ安価でAI agentを使うために

フリープランのAPI Provider: `OpenRouter` / Language Model: `claude-3.7-sonnet`のクレジットを使い切った。

既に[GitHub Copilot Pro](https://github.com/features/copilot) (年100ドル)を導入していたので、その範囲でClineを利用。

API Provider: `VS Code LM API` / Language Model: `copilot - gpt-4.1`にし、Plan
modeを選択すると通信量を抑えられ、安価に利用可能。

GitHub Copilot ProのAgent modeとも比較しながら使ってみる予定。

参考：

- <https://qiita.com/generokenken/items/ef761c49a8d23336642c>

---

## 2025-05-10: バージョン管理と時間管理

### バージョン管理

[asdf](https://asdf-vm.com/)から[mise](https://github.com/jdx/mise)へ乗り換え。Figmaの作者で、スポンサーも多く、プラグインの別管理が不要なのが利点。

mise有効化には、シェル初期化ファイルに以下を追加：

```sh
# See https://mise.jdx.dev/cli/activate.html
echo 'eval "$(mise activate zsh)"' >> ~/.zshrc
```

### 時間管理

脳の「実行機能」を働かせる4ステップ：

1. 「スタートする」
2. 「計画を立てる」
3. 「進捗をモニタリングする」
4. 「脱線を防止する」

参考：朝日新聞 be on Saturday 2025年5月10日号

---

## 2025-05-09: [Topic Title]

[Description of what you learned today]

### Example/Code (if applicable)

```txt
# Code example here
```

### References

- [Reference link 1](https://example.com)
- [Reference link 2](https://example.com)

---
